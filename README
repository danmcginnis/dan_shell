code cleaned up with gnu-indent

code checked with splint


